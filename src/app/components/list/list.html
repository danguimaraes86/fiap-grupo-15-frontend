<div class="container">
  <!-- Formulário de cadastro -->
  <app-transaction-form (transactionSaved)="loadTransactions()"></app-transaction-form>

  <!-- Resumo -->
  <mat-card class="summary-card">
    <mat-card-header>
      <mat-card-title>Resumo</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="summary-grid">
        <div class="summary-item receita">
          <span class="label">Receitas</span>
          <span class="value">{{ formatCurrency(totalReceitas) }}</span>
        </div>
        <div class="summary-item despesa">
          <span class="label">Despesas</span>
          <span class="value">{{ formatCurrency(totalDespesas) }}</span>
        </div>
        <div class="summary-item saldo" [class.negative]="saldo < 0">
          <span class="label">Saldo</span>
          <span class="value">{{ formatCurrency(saldo) }}</span>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Gráficos -->
  @if (!loading && transactions.length > 0) {
    <app-graphic [transactions]="transactions"></app-graphic>
  }

  <!-- Lista de Transações -->
  <mat-card>
    <mat-card-header>
      <mat-card-title>Transações</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      @if (loading) {
        <div class="loading-container">
          <mat-spinner></mat-spinner>
          <p>Carregando transações...</p>
        </div>
      }

      @if (!loading && transactions.length === 0) {
        <div class="empty-state">
          <p>Nenhuma transação cadastrada ainda.</p>
        </div>
      }

      @if (!loading && transactions.length > 0) {
        <table mat-table [dataSource]="transactions" class="transactions-table">
          <!-- Coluna Data -->
          <ng-container matColumnDef="data">
            <th mat-header-cell *matHeaderCellDef>Data</th>
            <td mat-cell *matCellDef="let transaction">{{ formatDate(transaction.data) }}</td>
          </ng-container>
          <!-- Coluna Descrição -->
          <ng-container matColumnDef="descricao">
            <th mat-header-cell *matHeaderCellDef>Descrição</th>
            <td mat-cell *matCellDef="let transaction">{{ transaction.descricao }}</td>
          </ng-container>
          <!-- Coluna Categoria -->
          <ng-container matColumnDef="categoria">
            <th mat-header-cell *matHeaderCellDef>Categoria</th>
            <td mat-cell *matCellDef="let transaction">
              <mat-chip>{{ transaction.categoria }}</mat-chip>
            </td>
          </ng-container>
          <!-- Coluna Tipo -->
          <ng-container matColumnDef="tipo">
            <th mat-header-cell *matHeaderCellDef>Tipo</th>
            <td mat-cell *matCellDef="let transaction">
              <mat-chip [class.receita-chip]="transaction.tipo === 'Receita'"
                [class.despesa-chip]="transaction.tipo === 'Despesa'">
                {{ transaction.tipo }}
              </mat-chip>
            </td>
          </ng-container>
          <!-- Coluna Valor -->
          <ng-container matColumnDef="valor">
            <th mat-header-cell *matHeaderCellDef>Valor</th>
            <td mat-cell *matCellDef="let transaction"
              [class.receita-value]="transaction.tipo === 'Receita'"
              [class.despesa-value]="transaction.tipo === 'Despesa'">
              {{ formatCurrency(transaction.valor) }}
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      }
    </mat-card-content>
  </mat-card>
</div>

